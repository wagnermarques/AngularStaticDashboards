<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Total Students: QT_MAT_ESP - Número de Matrículas na Educação Especial (INEP Census)</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #fff;
        }
        .controls {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        select {
            padding: 8px 16px;
            font-size: 16px;
            border-radius: 4px;
            border: 1px solid #ccc;
        }
        .chart-container {
            margin-bottom: 30px;
            height: 500px;
        }
        .table-container {
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            border: 1px solid #eee;
            border-radius: 8px;
            overflow-x: auto; /* Allow scroll for wide pivot tables */
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        h3 {
            text-align: center;
            color: #333;
            margin-top: 0;
            padding-top: 20px;
        }
        table.table {
            width: 100%;
            border-collapse: collapse;
            text-align: center;
            white-space: nowrap; /* Prevent wrapping in pivot tables */
        }
        table.table th, table.table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }
        table.table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #555;
        }
        table.table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        table.table tr:hover {
            background-color: #f1f1f1;
        }
    </style>
</head>
<body>
    <div class="controls">
        <label for="viewSelector">Visualizar por: </label>
        <select id="viewSelector" onchange="updateView()">
            <option value="Por Ano">Por Ano</option><option value="Por Estado">Por Estado</option>
        </select>
    </div>

    <div id="chartDiv" class="chart-container"></div>
    
    <div class="table-container">
        <h3>Tabela de Frequência</h3>
        <div id="tableDiv"></div>
    </div>

    <script>
        const dashboardData = {"Por Ano": {"traces": [{"x": [2021, 2022, 2023], "y": [1350921.0, 1527794.0, 1771430.0], "type": "bar", "marker": {"color": "#1976d2"}, "name": "Total"}], "table": "<table class=\"dataframe table table-striped\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>Ano do Censo</th>\n      <th>Quantidade</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>2021</td>\n      <td>1.350.921</td>\n    </tr>\n    <tr>\n      <td>2022</td>\n      <td>1.527.794</td>\n    </tr>\n    <tr>\n      <td>2023</td>\n      <td>1.771.430</td>\n    </tr>\n  </tbody>\n</table>", "x_label": "Ano do Censo", "is_clustered": false}, "Por Estado": {"traces": [{"x": ["Acre", "Alagoas", "Amap\u00e1", "Amazonas", "Bahia", "Cear\u00e1", "Distrito Federal", "Esp\u00edrito Santo", "Goi\u00e1s", "Maranh\u00e3o", "Mato Grosso", "Mato Grosso do Sul", "Minas Gerais", "Paran\u00e1", "Para\u00edba", "Par\u00e1", "Pernambuco", "Piau\u00ed", "Rio Grande do Norte", "Rio Grande do Sul", "Rio de Janeiro", "Rond\u00f4nia", "Roraima", "Santa Catarina", "Sergipe", "S\u00e3o Paulo", "Tocantins"], "y": [12735.0, 25675.0, 6781.0, 22299.0, 110365.0, 68206.0, 17518.0, 33061.0, 46684.0, 48014.0, 25730.0, 21526.0, 141636.0, 102609.0, 27918.0, 56326.0, 51113.0, 23985.0, 22278.0, 96212.0, 83769.0, 13099.0, 3652.0, 44919.0, 11949.0, 217524.0, 15338.0], "name": "2021", "type": "bar"}, {"x": ["Acre", "Alagoas", "Amap\u00e1", "Amazonas", "Bahia", "Cear\u00e1", "Distrito Federal", "Esp\u00edrito Santo", "Goi\u00e1s", "Maranh\u00e3o", "Mato Grosso", "Mato Grosso do Sul", "Minas Gerais", "Paran\u00e1", "Para\u00edba", "Par\u00e1", "Pernambuco", "Piau\u00ed", "Rio Grande do Norte", "Rio Grande do Sul", "Rio de Janeiro", "Rond\u00f4nia", "Roraima", "Santa Catarina", "Sergipe", "S\u00e3o Paulo", "Tocantins"], "y": [14469.0, 29608.0, 8000.0, 24797.0, 127652.0, 80283.0, 18827.0, 37731.0, 51808.0, 53270.0, 28518.0, 23108.0, 157430.0, 114584.0, 30970.0, 62496.0, 60464.0, 27999.0, 25143.0, 106891.0, 96773.0, 14341.0, 4301.0, 54056.0, 13877.0, 243854.0, 16544.0], "name": "2022", "type": "bar"}, {"x": ["Acre", "Alagoas", "Amap\u00e1", "Amazonas", "Bahia", "Cear\u00e1", "Distrito Federal", "Esp\u00edrito Santo", "Goi\u00e1s", "Maranh\u00e3o", "Mato Grosso", "Mato Grosso do Sul", "Minas Gerais", "Paran\u00e1", "Para\u00edba", "Par\u00e1", "Pernambuco", "Piau\u00ed", "Rio Grande do Norte", "Rio Grande do Sul", "Rio de Janeiro", "Rond\u00f4nia", "Roraima", "Santa Catarina", "Sergipe", "S\u00e3o Paulo", "Tocantins"], "y": [17661.0, 34145.0, 9874.0, 28830.0, 158699.0, 97767.0, 20932.0, 42878.0, 60718.0, 62482.0, 31207.0, 26155.0, 174109.0, 128427.0, 39098.0, 71269.0, 72872.0, 33471.0, 29532.0, 117389.0, 109992.0, 16279.0, 5446.0, 67534.0, 17348.0, 279571.0, 17745.0], "name": "2023", "type": "bar"}], "table": "<table class=\"dataframe table table-striped\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>NU_ANO_CENSO</th>\n      <th>Unidade da Federa\u00e7\u00e3o</th>\n      <th>2021</th>\n      <th>2022</th>\n      <th>2023</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th></th>\n      <td>Acre</td>\n      <td>12.735</td>\n      <td>14.469</td>\n      <td>17.661</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Alagoas</td>\n      <td>25.675</td>\n      <td>29.608</td>\n      <td>34.145</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Amap\u00e1</td>\n      <td>6.781</td>\n      <td>8.000</td>\n      <td>9.874</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Amazonas</td>\n      <td>22.299</td>\n      <td>24.797</td>\n      <td>28.830</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Bahia</td>\n      <td>110.365</td>\n      <td>127.652</td>\n      <td>158.699</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Cear\u00e1</td>\n      <td>68.206</td>\n      <td>80.283</td>\n      <td>97.767</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Distrito Federal</td>\n      <td>17.518</td>\n      <td>18.827</td>\n      <td>20.932</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Esp\u00edrito Santo</td>\n      <td>33.061</td>\n      <td>37.731</td>\n      <td>42.878</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Goi\u00e1s</td>\n      <td>46.684</td>\n      <td>51.808</td>\n      <td>60.718</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Maranh\u00e3o</td>\n      <td>48.014</td>\n      <td>53.270</td>\n      <td>62.482</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Mato Grosso</td>\n      <td>25.730</td>\n      <td>28.518</td>\n      <td>31.207</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Mato Grosso do Sul</td>\n      <td>21.526</td>\n      <td>23.108</td>\n      <td>26.155</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Minas Gerais</td>\n      <td>141.636</td>\n      <td>157.430</td>\n      <td>174.109</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Paran\u00e1</td>\n      <td>102.609</td>\n      <td>114.584</td>\n      <td>128.427</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Para\u00edba</td>\n      <td>27.918</td>\n      <td>30.970</td>\n      <td>39.098</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Par\u00e1</td>\n      <td>56.326</td>\n      <td>62.496</td>\n      <td>71.269</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Pernambuco</td>\n      <td>51.113</td>\n      <td>60.464</td>\n      <td>72.872</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Piau\u00ed</td>\n      <td>23.985</td>\n      <td>27.999</td>\n      <td>33.471</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Rio Grande do Norte</td>\n      <td>22.278</td>\n      <td>25.143</td>\n      <td>29.532</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Rio Grande do Sul</td>\n      <td>96.212</td>\n      <td>106.891</td>\n      <td>117.389</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Rio de Janeiro</td>\n      <td>83.769</td>\n      <td>96.773</td>\n      <td>109.992</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Rond\u00f4nia</td>\n      <td>13.099</td>\n      <td>14.341</td>\n      <td>16.279</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Roraima</td>\n      <td>3.652</td>\n      <td>4.301</td>\n      <td>5.446</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Santa Catarina</td>\n      <td>44.919</td>\n      <td>54.056</td>\n      <td>67.534</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Sergipe</td>\n      <td>11.949</td>\n      <td>13.877</td>\n      <td>17.348</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>S\u00e3o Paulo</td>\n      <td>217.524</td>\n      <td>243.854</td>\n      <td>279.571</td>\n    </tr>\n    <tr>\n      <th></th>\n      <td>Tocantins</td>\n      <td>15.338</td>\n      <td>16.544</td>\n      <td>17.745</td>\n    </tr>\n  </tbody>\n</table>", "x_label": "Unidade da Federa\u00e7\u00e3o", "is_clustered": true}};
        
        function updateView() {
            const key = document.getElementById('viewSelector').value;
            const data = dashboardData[key];
            
            const layout = {
                title: 'Total Students: QT_MAT_ESP - Número de Matrículas na Educação Especial (INEP Census)',
                xaxis: { type: 'category', title: data.x_label, automargin: true },
                yaxis: { title: 'Quantidade' },
                template: 'plotly_white',
                margin: { t: 40, b: 100, l: 60, r: 20 },
                barmode: data.is_clustered ? 'group' : 'relative',
                autosize: true,
                legend: { orientation: 'h', y: 1.1 }
            };
            
            const config = { responsive: true, displayModeBar: false };
            
            // Use newPlot to handle changing number of traces cleanly
            Plotly.newPlot('chartDiv', data.traces, layout, config);
            document.getElementById('tableDiv').innerHTML = data.table;
        }

        // Initialize
        updateView();
        
        window.onresize = function() {
            Plotly.Plots.resize('chartDiv');
        };
    </script>
</body>
</html>